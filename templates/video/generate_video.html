{% extends 'base.html' %}

{% block content %}


    {% if error %}
        <h3>{{ error }}</h3>
    {% else %}
        {{ video.file }}
        <button id="transcription">Generate transcription</button>
    {% endif %}
{% endblock %}

{% block javascript %}
<script>

function generate_transcript(){
    console.log('automatic speech-to-text transcription starting....')
     $.ajax({
                type : "POST",
                url: "/ajax/transcribe/",
                data: {
                 video_file : '{{ video.file }}',
                 language : '{{ video.language }}',
                 access_code : '{{ video.access_code }}',
                 csrfmiddlewaretoken: '{{ csrf_token }}',
                 dataType: "json",

                },

                success: function(data){
                   alert(data['msg']);
                },

                failure: function(error) {
                    alert(error);
                }
            });
}

    $("#transcription").on('click', function (e) {
        e.preventDefault();
        $.ajax({
                type : "POST",
                url: "/ajax/upload_video/",
                data: {
                 id : '{{ video.id }}',
                 csrfmiddlewaretoken: '{{ csrf_token }}',
                 dataType: "json",

                },

                success: function(data){
                   console.log(data['msg']);
                   generate_transcript();
                },

                failure: function(error) {
                    alert(error);
                }


            });


    })
</script>
{% endblock  %}